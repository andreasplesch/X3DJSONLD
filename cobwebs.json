{
  "X3D": {
    "@profile": "Immersive",
    "@version": 3.3,
    "@xsd:noNamespaceSchemaLocation": "http://www.web3d.org/specifications/x3d-3.3.xsd",
    "head": {
      "meta": [
        {
          "@name": "title",
          "@content": "geo.x3d"
        },
        {
          "@name": "creator",
          "@content": "John Carlson"
        },
        {
          "@name": "description",
          "@content": "Tour around a prismatic sphere"
        },
        {
          "@name": "generator",
          "@content": "X3D-Edit, https://savage.nps.edu/X3D-Edit"
        },
        {
          "@name": "identifier",
          "@content": "http://coderextreme.net/X3DJSONLD/geo.x3d"
        }
      ]
    },
    "Scene": {
      "-children": [
        {
          "NavigationInfo": {
            "@type": [
              "ANY",
              "WALK",
              "EXAMINE",
              "FLY",
              "LOOKAT"
            ]
          }
        },
        {
          "Viewpoint": {
            "@position": [
              0,
              0,
              4
            ],
            "@orientation": [
              1,
              0,
              0,
              0
            ],
            "@description": "Bubbles in action"
          }
        },
        {
          "Background": {
            "@backUrl": [
              "cubemap/BK.png",
              "http://coderextreme.net/X3DJSONLD/cubemap/BK.png"
            ],
            "@bottomUrl": [
              "cubemap/BT.png",
              "http://coderextreme.net/X3DJSONLD/cubemap/BT.png"
            ],
            "@frontUrl": [
              "cubemap/FR.png",
              "http://coderextreme.net/X3DJSONLD/cubemap/FR.png"
            ],
            "@leftUrl": [
              "cubemap/LF.png",
              "http://coderextreme.net/X3DJSONLD/cubemap/LF.png"
            ],
            "@rightUrl": [
              "cubemap/RT.png",
              "http://coderextreme.net/X3DJSONLD/cubemap/RT.png"
            ],
            "@topUrl": [
              "cubemap/TP.png",
              "http://coderextreme.net/X3DJSONLD/cubemap/TP.png"
            ]
          }
        },
        {},
        {
          "Group": {
            "-children": [
              {
                "Transform": {
                  "@DEF": "transformBubblebubbleABubble",
                  "-children": [
                    {
                      "Shape": {
                        "-geometry": [
                          {
                            "Sphere": {
                              "@radius": 0.25
                            }
                          }
                        ],
                        "-appearance": [
                          {
                            "Appearance": {
                              "-material": [
                                {
                                  "Material": {
                                    "@diffuseColor": [
                                      1,
                                      0,
                                      0
                                    ],
                                    "@transparency": 0.2
                                  }
                                }
                              ]
                            }
                          }
                        ]
                      }
                    },
                    {
                      "Script": {
                        "@DEF": "bounceBubblebubbleABubble",
                        "field": [
                          {
                            "@name": "scale",
                            "@accessType": "inputOutput",
                            "@type": "SFVec3f",
                            "@value": [
                              1,
                              1,
                              1
                            ]
                          },
                          {
                            "@name": "translation",
                            "@accessType": "inputOutput",
                            "@type": "SFVec3f",
                            "@value": [
                              0,
                              0,
                              0
                            ]
                          },
                          {
                            "@name": "velocity",
                            "@accessType": "inputOutput",
                            "@type": "SFVec3f",
                            "@value": [
                              0,
                              0,
                              0
                            ]
                          },
                          {
                            "@name": "scalvel",
                            "@accessType": "inputOutput",
                            "@type": "SFVec3f",
                            "@value": [
                              0,
                              0,
                              0
                            ]
                          },
                          {
                            "@name": "set_fraction",
                            "@accessType": "inputOnly",
                            "@type": "SFTime"
                          }
                        ],
                        "#sourceText": [
                          "ecmascript:",
                          "function initialize() {",
                          "    velocity = new SFVec3f(Math.random() * 0.25 - 0.125, Math.random() * 0.25 - 0.125, Math.random() * 0.25 - 0.125);",
                          "",
                          "    scalvel = new SFVec3f(Math.random() * 0.4, Math.random() * 0.4, Math.random() * 0.4);",
                          "}",
                          "",
                          "function set_translation(value) {",
                          "   translation = value;",
                          "}",
                          "",
                          "function set_scale(value) {",
                          "   scale = value;",
                          "}",
                          "",
                          "function translation_changed() {",
                          "\treturn translation;",
                          "}",
                          "",
                          "function set_fraction(value) {",
                          "    translation = new SFVec3f(\ttranslation[0] + velocity[0], translation[1] + velocity[1], translation[2] + velocity[2]);",
                          "    scale = new SFVec3f(scale[0] + scalvel[0], scale[1] + scalvel[1], scale[2] + scalvel[2]);",
                          "    for (var j = 0; j < 3; j++) {",
                          "\t    // if you get to far away or too big, explode",
                          "\t    if ( Math.abs(translation[j]) > 256) {",
                          "\t\ttranslation[j] = 0;",
                          "\t\tinitialize();",
                          "\t    }",
                          "\t    if (Math.abs(scale[j]) > 20) {",
                          "\t\tscale[j] = scale[j]/2;",
                          "\t\ttranslation[j] = 0;",
                          "\t\tinitialize();",
                          "\t    }",
                          "    }",
                          "}"
                        ],
                        "@class": "bounceBubblebubbleABubble"
                      }
                    },
                    {
                      "TimeSensor": {
                        "@DEF": "bubbleClockBubblebubbleABubble",
                        "@cycleInterval": 10,
                        "@loop": true,
                        "@class": "bubbleClockBubblebubbleABubble"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "transformBubblebubbleABubble",
                        "@fromField": "translation_changed",
                        "@toNode": "bounceBubblebubbleABubble",
                        "@toField": "set_translation"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "transformBubblebubbleABubble",
                        "@fromField": "scale_changed",
                        "@toNode": "bounceBubblebubbleABubble",
                        "@toField": "set_scale"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "bounceBubblebubbleABubble",
                        "@fromField": "translation_changed",
                        "@toNode": "transformBubblebubbleABubble",
                        "@toField": "set_translation"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "bounceBubblebubbleABubble",
                        "@fromField": "scale_changed",
                        "@toNode": "transformBubblebubbleABubble",
                        "@toField": "set_scale"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "bubbleClockBubblebubbleABubble",
                        "@fromField": "fraction_changed",
                        "@toNode": "bounceBubblebubbleABubble",
                        "@toField": "set_fraction"
                      }
                    }
                  ],
                  "@class": "transformBubblebubbleABubble"
                }
              }
            ],
            "@DEF": "bubbleABubble",
            "@class": "bubbleABubble"
          }
        },
        {
          "Group": {
            "-children": [
              {
                "Transform": {
                  "@DEF": "transformBubblebubbleBBubble",
                  "-children": [
                    {
                      "Shape": {
                        "-geometry": [
                          {
                            "Sphere": {
                              "@radius": 0.25
                            }
                          }
                        ],
                        "-appearance": [
                          {
                            "Appearance": {
                              "-material": [
                                {
                                  "Material": {
                                    "@diffuseColor": [
                                      1,
                                      0,
                                      0
                                    ],
                                    "@transparency": 0.2
                                  }
                                }
                              ]
                            }
                          }
                        ]
                      }
                    },
                    {
                      "Script": {
                        "@DEF": "bounceBubblebubbleBBubble",
                        "field": [
                          {
                            "@name": "scale",
                            "@accessType": "inputOutput",
                            "@type": "SFVec3f",
                            "@value": [
                              1,
                              1,
                              1
                            ]
                          },
                          {
                            "@name": "translation",
                            "@accessType": "inputOutput",
                            "@type": "SFVec3f",
                            "@value": [
                              0,
                              0,
                              0
                            ]
                          },
                          {
                            "@name": "velocity",
                            "@accessType": "inputOutput",
                            "@type": "SFVec3f",
                            "@value": [
                              0,
                              0,
                              0
                            ]
                          },
                          {
                            "@name": "scalvel",
                            "@accessType": "inputOutput",
                            "@type": "SFVec3f",
                            "@value": [
                              0,
                              0,
                              0
                            ]
                          },
                          {
                            "@name": "set_fraction",
                            "@accessType": "inputOnly",
                            "@type": "SFTime"
                          }
                        ],
                        "#sourceText": [
                          "ecmascript:",
                          "function initialize() {",
                          "    velocity = new SFVec3f(Math.random() * 0.25 - 0.125, Math.random() * 0.25 - 0.125, Math.random() * 0.25 - 0.125);",
                          "",
                          "    scalvel = new SFVec3f(Math.random() * 0.4, Math.random() * 0.4, Math.random() * 0.4);",
                          "}",
                          "",
                          "function set_translation(value) {",
                          "   translation = value;",
                          "}",
                          "",
                          "function set_scale(value) {",
                          "   scale = value;",
                          "}",
                          "",
                          "function translation_changed() {",
                          "\treturn translation;",
                          "}",
                          "",
                          "function set_fraction(value) {",
                          "    translation = new SFVec3f(\ttranslation[0] + velocity[0], translation[1] + velocity[1], translation[2] + velocity[2]);",
                          "    scale = new SFVec3f(scale[0] + scalvel[0], scale[1] + scalvel[1], scale[2] + scalvel[2]);",
                          "    for (var j = 0; j < 3; j++) {",
                          "\t    // if you get to far away or too big, explode",
                          "\t    if ( Math.abs(translation[j]) > 256) {",
                          "\t\ttranslation[j] = 0;",
                          "\t\tinitialize();",
                          "\t    }",
                          "\t    if (Math.abs(scale[j]) > 20) {",
                          "\t\tscale[j] = scale[j]/2;",
                          "\t\ttranslation[j] = 0;",
                          "\t\tinitialize();",
                          "\t    }",
                          "    }",
                          "}"
                        ],
                        "@class": "bounceBubblebubbleBBubble"
                      }
                    },
                    {
                      "TimeSensor": {
                        "@DEF": "bubbleClockBubblebubbleBBubble",
                        "@cycleInterval": 10,
                        "@loop": true,
                        "@class": "bubbleClockBubblebubbleBBubble"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "transformBubblebubbleBBubble",
                        "@fromField": "translation_changed",
                        "@toNode": "bounceBubblebubbleBBubble",
                        "@toField": "set_translation"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "transformBubblebubbleBBubble",
                        "@fromField": "scale_changed",
                        "@toNode": "bounceBubblebubbleBBubble",
                        "@toField": "set_scale"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "bounceBubblebubbleBBubble",
                        "@fromField": "translation_changed",
                        "@toNode": "transformBubblebubbleBBubble",
                        "@toField": "set_translation"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "bounceBubblebubbleBBubble",
                        "@fromField": "scale_changed",
                        "@toNode": "transformBubblebubbleBBubble",
                        "@toField": "set_scale"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "bubbleClockBubblebubbleBBubble",
                        "@fromField": "fraction_changed",
                        "@toNode": "bounceBubblebubbleBBubble",
                        "@toField": "set_fraction"
                      }
                    }
                  ],
                  "@class": "transformBubblebubbleBBubble"
                }
              }
            ],
            "@DEF": "bubbleBBubble",
            "@class": "bubbleBBubble"
          }
        },
        {
          "Group": {
            "-children": [
              {
                "Transform": {
                  "@DEF": "transformBubblebubbleCBubble",
                  "-children": [
                    {
                      "Shape": {
                        "-geometry": [
                          {
                            "Sphere": {
                              "@radius": 0.25
                            }
                          }
                        ],
                        "-appearance": [
                          {
                            "Appearance": {
                              "-material": [
                                {
                                  "Material": {
                                    "@diffuseColor": [
                                      1,
                                      0,
                                      0
                                    ],
                                    "@transparency": 0.2
                                  }
                                }
                              ]
                            }
                          }
                        ]
                      }
                    },
                    {
                      "Script": {
                        "@DEF": "bounceBubblebubbleCBubble",
                        "field": [
                          {
                            "@name": "scale",
                            "@accessType": "inputOutput",
                            "@type": "SFVec3f",
                            "@value": [
                              1,
                              1,
                              1
                            ]
                          },
                          {
                            "@name": "translation",
                            "@accessType": "inputOutput",
                            "@type": "SFVec3f",
                            "@value": [
                              0,
                              0,
                              0
                            ]
                          },
                          {
                            "@name": "velocity",
                            "@accessType": "inputOutput",
                            "@type": "SFVec3f",
                            "@value": [
                              0,
                              0,
                              0
                            ]
                          },
                          {
                            "@name": "scalvel",
                            "@accessType": "inputOutput",
                            "@type": "SFVec3f",
                            "@value": [
                              0,
                              0,
                              0
                            ]
                          },
                          {
                            "@name": "set_fraction",
                            "@accessType": "inputOnly",
                            "@type": "SFTime"
                          }
                        ],
                        "#sourceText": [
                          "ecmascript:",
                          "function initialize() {",
                          "    velocity = new SFVec3f(Math.random() * 0.25 - 0.125, Math.random() * 0.25 - 0.125, Math.random() * 0.25 - 0.125);",
                          "",
                          "    scalvel = new SFVec3f(Math.random() * 0.4, Math.random() * 0.4, Math.random() * 0.4);",
                          "}",
                          "",
                          "function set_translation(value) {",
                          "   translation = value;",
                          "}",
                          "",
                          "function set_scale(value) {",
                          "   scale = value;",
                          "}",
                          "",
                          "function translation_changed() {",
                          "\treturn translation;",
                          "}",
                          "",
                          "function set_fraction(value) {",
                          "    translation = new SFVec3f(\ttranslation[0] + velocity[0], translation[1] + velocity[1], translation[2] + velocity[2]);",
                          "    scale = new SFVec3f(scale[0] + scalvel[0], scale[1] + scalvel[1], scale[2] + scalvel[2]);",
                          "    for (var j = 0; j < 3; j++) {",
                          "\t    // if you get to far away or too big, explode",
                          "\t    if ( Math.abs(translation[j]) > 256) {",
                          "\t\ttranslation[j] = 0;",
                          "\t\tinitialize();",
                          "\t    }",
                          "\t    if (Math.abs(scale[j]) > 20) {",
                          "\t\tscale[j] = scale[j]/2;",
                          "\t\ttranslation[j] = 0;",
                          "\t\tinitialize();",
                          "\t    }",
                          "    }",
                          "}"
                        ],
                        "@class": "bounceBubblebubbleCBubble"
                      }
                    },
                    {
                      "TimeSensor": {
                        "@DEF": "bubbleClockBubblebubbleCBubble",
                        "@cycleInterval": 10,
                        "@loop": true,
                        "@class": "bubbleClockBubblebubbleCBubble"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "transformBubblebubbleCBubble",
                        "@fromField": "translation_changed",
                        "@toNode": "bounceBubblebubbleCBubble",
                        "@toField": "set_translation"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "transformBubblebubbleCBubble",
                        "@fromField": "scale_changed",
                        "@toNode": "bounceBubblebubbleCBubble",
                        "@toField": "set_scale"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "bounceBubblebubbleCBubble",
                        "@fromField": "translation_changed",
                        "@toNode": "transformBubblebubbleCBubble",
                        "@toField": "set_translation"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "bounceBubblebubbleCBubble",
                        "@fromField": "scale_changed",
                        "@toNode": "transformBubblebubbleCBubble",
                        "@toField": "set_scale"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "bubbleClockBubblebubbleCBubble",
                        "@fromField": "fraction_changed",
                        "@toNode": "bounceBubblebubbleCBubble",
                        "@toField": "set_fraction"
                      }
                    }
                  ],
                  "@class": "transformBubblebubbleCBubble"
                }
              }
            ],
            "@DEF": "bubbleCBubble",
            "@class": "bubbleCBubble"
          }
        },
        {
          "Group": {
            "-children": [
              {
                "Transform": {
                  "@DEF": "transformBubblebubbleDBubble",
                  "-children": [
                    {
                      "Shape": {
                        "-geometry": [
                          {
                            "Sphere": {
                              "@radius": 0.25
                            }
                          }
                        ],
                        "-appearance": [
                          {
                            "Appearance": {
                              "-material": [
                                {
                                  "Material": {
                                    "@diffuseColor": [
                                      1,
                                      0,
                                      0
                                    ],
                                    "@transparency": 0.2
                                  }
                                }
                              ]
                            }
                          }
                        ]
                      }
                    },
                    {
                      "Script": {
                        "@DEF": "bounceBubblebubbleDBubble",
                        "field": [
                          {
                            "@name": "scale",
                            "@accessType": "inputOutput",
                            "@type": "SFVec3f",
                            "@value": [
                              1,
                              1,
                              1
                            ]
                          },
                          {
                            "@name": "translation",
                            "@accessType": "inputOutput",
                            "@type": "SFVec3f",
                            "@value": [
                              0,
                              0,
                              0
                            ]
                          },
                          {
                            "@name": "velocity",
                            "@accessType": "inputOutput",
                            "@type": "SFVec3f",
                            "@value": [
                              0,
                              0,
                              0
                            ]
                          },
                          {
                            "@name": "scalvel",
                            "@accessType": "inputOutput",
                            "@type": "SFVec3f",
                            "@value": [
                              0,
                              0,
                              0
                            ]
                          },
                          {
                            "@name": "set_fraction",
                            "@accessType": "inputOnly",
                            "@type": "SFTime"
                          }
                        ],
                        "#sourceText": [
                          "ecmascript:",
                          "function initialize() {",
                          "    velocity = new SFVec3f(Math.random() * 0.25 - 0.125, Math.random() * 0.25 - 0.125, Math.random() * 0.25 - 0.125);",
                          "",
                          "    scalvel = new SFVec3f(Math.random() * 0.4, Math.random() * 0.4, Math.random() * 0.4);",
                          "}",
                          "",
                          "function set_translation(value) {",
                          "   translation = value;",
                          "}",
                          "",
                          "function set_scale(value) {",
                          "   scale = value;",
                          "}",
                          "",
                          "function translation_changed() {",
                          "\treturn translation;",
                          "}",
                          "",
                          "function set_fraction(value) {",
                          "    translation = new SFVec3f(\ttranslation[0] + velocity[0], translation[1] + velocity[1], translation[2] + velocity[2]);",
                          "    scale = new SFVec3f(scale[0] + scalvel[0], scale[1] + scalvel[1], scale[2] + scalvel[2]);",
                          "    for (var j = 0; j < 3; j++) {",
                          "\t    // if you get to far away or too big, explode",
                          "\t    if ( Math.abs(translation[j]) > 256) {",
                          "\t\ttranslation[j] = 0;",
                          "\t\tinitialize();",
                          "\t    }",
                          "\t    if (Math.abs(scale[j]) > 20) {",
                          "\t\tscale[j] = scale[j]/2;",
                          "\t\ttranslation[j] = 0;",
                          "\t\tinitialize();",
                          "\t    }",
                          "    }",
                          "}"
                        ],
                        "@class": "bounceBubblebubbleDBubble"
                      }
                    },
                    {
                      "TimeSensor": {
                        "@DEF": "bubbleClockBubblebubbleDBubble",
                        "@cycleInterval": 10,
                        "@loop": true,
                        "@class": "bubbleClockBubblebubbleDBubble"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "transformBubblebubbleDBubble",
                        "@fromField": "translation_changed",
                        "@toNode": "bounceBubblebubbleDBubble",
                        "@toField": "set_translation"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "transformBubblebubbleDBubble",
                        "@fromField": "scale_changed",
                        "@toNode": "bounceBubblebubbleDBubble",
                        "@toField": "set_scale"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "bounceBubblebubbleDBubble",
                        "@fromField": "translation_changed",
                        "@toNode": "transformBubblebubbleDBubble",
                        "@toField": "set_translation"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "bounceBubblebubbleDBubble",
                        "@fromField": "scale_changed",
                        "@toNode": "transformBubblebubbleDBubble",
                        "@toField": "set_scale"
                      }
                    },
                    {
                      "ROUTE": {
                        "@fromNode": "bubbleClockBubblebubbleDBubble",
                        "@fromField": "fraction_changed",
                        "@toNode": "bounceBubblebubbleDBubble",
                        "@toField": "set_fraction"
                      }
                    }
                  ],
                  "@class": "transformBubblebubbleDBubble"
                }
              }
            ],
            "@DEF": "bubbleDBubble",
            "@class": "bubbleDBubble"
          }
        }
      ]
    }
  }
}
